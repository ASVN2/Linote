{"ast":null,"code":"import _regeneratorRuntime from\"/home/av/Desktop/linote/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/home/av/Desktop/linote/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/home/av/Desktop/linote/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useReducer,useState,useEffect}from'react';import{db}from'../firebase/config';//firebase imports\nimport{addDoc,collection,deleteDoc,doc}from'firebase/firestore';var initState={document:null,isPending:false,error:null,success:null};export var firebaseReducer=function firebaseReducer(state,action){switch(action.type){case'IS_PENDING':return{isPending:true,document:null,error:null,success:false};case'ADDED_DOCUMENT':return{isPending:false,document:action.payload,error:null,success:true};case'ERROR':return{isPending:false,document:null,error:action.payload,success:false};case'DELETED_DOCUMENT':return{isPending:false,document:action.payload,error:null,success:true};default:return state;}};export var Firebase=function Firebase(col){var _useReducer=useReducer(firebaseReducer,initState),_useReducer2=_slicedToArray(_useReducer,2),response=_useReducer2[0],dispatch=_useReducer2[1];var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isCancelled=_useState2[0],setIsCancelled=_useState2[1];// function check for is it isCancelled or not and then dispatch the action\nvar dispatchCanlled=function dispatchCanlled(action){if(!isCancelled){dispatch(action);}};var ref=collection(db,col);// add document\nvar addDocument=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(mdoc){var addedDoc;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:dispatch({type:'IS_PENDING'});_context.prev=1;_context.next=4;return addDoc(ref,mdoc);case 4:addedDoc=_context.sent;dispatchCanlled({type:'ADDED_DOCUMENT',payload:addedDoc});_context.next=12;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](1);console.log(_context.t0.message);dispatchCanlled({type:'ERROR',payload:_context.t0.message});case 12:console.log(mdoc);case 13:case\"end\":return _context.stop();}},_callee,null,[[1,8]]);}));return function addDocument(_x){return _ref.apply(this,arguments);};}();// remove document\nvar removeDoc=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(id){var deleteddoc;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:dispatch({type:'IS_PENDING'});_context2.prev=1;_context2.next=4;return deleteDoc(doc(db,col,id));case 4:deleteddoc=_context2.sent;dispatchCanlled({type:'DELETED_DOCUMENT',payload:deleteddoc});_context2.next=12;break;case 8:_context2.prev=8;_context2.t0=_context2[\"catch\"](1);console.log(_context2.t0.message);dispatchCanlled({type:'ERROR',payload:_context2.t0.message});case 12:case\"end\":return _context2.stop();}},_callee2,null,[[1,8]]);}));return function removeDoc(_x2){return _ref2.apply(this,arguments);};}();return{addDocument:addDocument,removeDoc:removeDoc};};","map":{"version":3,"names":["useReducer","useState","useEffect","db","addDoc","collection","deleteDoc","doc","initState","document","isPending","error","success","firebaseReducer","state","action","type","payload","Firebase","col","_useReducer","_useReducer2","_slicedToArray","response","dispatch","_useState","_useState2","isCancelled","setIsCancelled","dispatchCanlled","ref","addDocument","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","mdoc","addedDoc","wrap","_callee$","_context","prev","next","sent","t0","console","log","message","stop","_x","apply","arguments","removeDoc","_ref2","_callee2","id","deleteddoc","_callee2$","_context2","_x2"],"sources":["/home/av/Desktop/linote/src/hooks/useFirebase.js"],"sourcesContent":["import { useReducer, useState, useEffect } from 'react';\nimport { db } from '../firebase/config';\n\n//firebase imports\nimport { addDoc, collection, deleteDoc, doc } from 'firebase/firestore';\n\nlet initState = {\n  document: null,\n  isPending: false,\n  error: null,\n  success: null,\n};\n\nexport const firebaseReducer = (state, action) => {\n  switch (action.type) {\n    case 'IS_PENDING':\n      return { isPending: true, document: null, error: null, success: false };\n    case 'ADDED_DOCUMENT':\n      return { isPending: false, document: action.payload, error: null, success: true };\n    case 'ERROR':\n      return { isPending: false, document: null, error: action.payload, success: false };\n    case 'DELETED_DOCUMENT':\n      return { isPending: false, document: action.payload, error: null, success: true };\n\n    default:\n      return state;\n  }\n};\n\nexport const Firebase = (col) => {\n  const [response, dispatch] = useReducer(firebaseReducer, initState);\n  const [isCancelled, setIsCancelled] = useState(false);\n\n  // function check for is it isCancelled or not and then dispatch the action\n  const dispatchCanlled = (action) => {\n    if (!isCancelled) {\n      dispatch(action);\n    }\n  };\n\n  let ref = collection(db, col);\n\n  // add document\n  const addDocument = async (mdoc) => {\n    dispatch({ type: 'IS_PENDING' });\n\n    try {\n      const addedDoc = await addDoc(ref, mdoc);\n      dispatchCanlled({ type: 'ADDED_DOCUMENT', payload: addedDoc });\n    } catch (error) {\n      console.log(error.message);\n      dispatchCanlled({ type: 'ERROR', payload: error.message });\n    }\n    console.log(mdoc);\n  };\n\n  // remove document\n\n  const removeDoc = async (id) => {\n    dispatch({ type: 'IS_PENDING' });\n\n    try {\n      const deleteddoc = await deleteDoc(doc(db, col, id));\n      dispatchCanlled({ type: 'DELETED_DOCUMENT', payload: deleteddoc });\n    } catch (error) {\n      console.log(error.message);\n      dispatchCanlled({ type: 'ERROR', payload: error.message });\n    }\n  };\n\n  return { addDocument, removeDoc };\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}